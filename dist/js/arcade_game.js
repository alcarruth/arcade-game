// Generated by CoffeeScript 2.4.1
(function() {
  var Enemy, Engine, Entity, Player, Resources, Score_Board, init,
    boundMethodCheck = function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } };

  Resources = class Resources {
    constructor() {
      this._load = this._load.bind(this);
      this.load = this.load.bind(this);
      this.get = this.get.bind(this);
      this.isReady = this.isReady.bind(this);
      this.onReady = this.onReady.bind(this);
      this.resourceCache = {};
      this.readyCallbacks = [];
    }

    _load(url) {
      var img;
      if (this.resourceCache[url]) {
        return this.resourceCache[url];
      } else {
        this.resourceCache[url] = void 0;
        img = new Image();
        img.src = url;
        return img.onload = () => {
          this.resourceCache[url] = img;
          if (this.isReady()) {
            return this.readyCallbacks.forEach(function(cb) {
              return cb();
            });
          }
        };
      }
    }

    load(urls) {
      if (urls instanceof Array) {
        return urls.forEach(this._load);
      } else {
        return this._load(urls);
      }
    }

    get(url) {
      return this.resourceCache[url];
    }

    isReady() {
      var _, ready, ref, resource;
      ready = true;
      ref = this.resourceCache;
      for (_ in ref) {
        resource = ref[_];
        ready &= resource != null;
      }
      return ready;
    }

    onReady(cb) {
      return this.readyCallbacks.push(cb);
    }

  };

  Score_Board = class Score_Board {
    constructor(engine1) {
      this.update = this.update.bind(this);
      this.engine = engine1;
      this.score_elt = document.getElementById("score");
      this.lives_elt = document.getElementById("lives");
    }

    update() {
      this.score_elt.innerHTML = `Score: ${this.engine.score}`;
      return this.lives_elt.innerHTML = `Lives: ${this.engine.lives}`;
    }

  };

  Engine = class Engine {
    constructor() {
      // class Engine methods

      // player getter() and setter() methods
      this.setPlayer = this.setPlayer.bind(this);
      this.getPlayer = this.getPlayer.bind(this);
      // add and get enemies
      this.addEnemy = this.addEnemy.bind(this);
      this.getEnemies = this.getEnemies.bind(this);
      // main loop
      this.main = this.main.bind(this);
      // pause the game
      this.toggle_pause = this.toggle_pause.bind(this);
      // initialize and start the game
      this.init = this.init.bind(this);
      this.stop = this.stop.bind(this);
      this.start = this.start.bind(this);
      // handle player key press
      this.on_keyup = this.on_keyup.bind(this);
      // update the positions of the entities and act accordingly
      this.update = this.update.bind(this);
      // render the game board
      this.render = this.render.bind(this);
      // reset game 
      this.reset = this.reset.bind(this);
      this.numCols = 5;
      this.numRows = 6;
      this.initLives = 10;
      this.colWidth = 101;
      this.rowHeight = 83;
      this.score_board = new Score_Board(this);
      this.lastTime = null;
      this.enemies = [];
      this.player = null;
      this.paused = false;
      this.rowImages = [
        'images/water-block.png', // Top row is water
        'images/stone-block.png', // Row 1 of 3 of stone
        'images/stone-block.png', // Row 2 of 3 of stone
        'images/stone-block.png', // Row 3 of 3 of stone
        'images/grass-block.png', // Row 1 of 2 of grass
        'images/grass-block.png' // Row 2 of 2 of grass
      ];
      this.resources = new Resources();
      this.resources.onReady(this.reset);
      this.resources.load(['images/stone-block.png', 'images/water-block.png', 'images/grass-block.png', 'images/enemy-bug.png', 'images/char-boy.png']);
      this.canvas = document.createElement('canvas');
      this.canvas.width = this.numCols * this.colWidth;
      this.canvas.height = this.numRows * this.rowHeight + 100;
      this.context = this.canvas.getContext('2d');
      document.body.appendChild(this.canvas);
      document.addEventListener('keyup', this.on_keyup);
    }

    setPlayer(p) {
      return this.player = p;
    }

    getPlayer() {
      return this.player;
    }

    addEnemy(e) {
      return this.enemies.push(e);
    }

    getEnemies() {
      return this.enemies;
    }

    main() {
      var dt, now;
      now = Date.now();
      dt = (now - this.lastTime) / 1000.0;
      this.update(dt);
      this.render();
      if (!this.paused && this.lives > 0) {
        this.lastTime = now;
        return window.requestAnimationFrame(this.main);
      }
    }

    toggle_pause() {
      if (this.paused) {
        return this.start();
      } else {
        return this.stop();
      }
    }

    init() {
      this.paused = true;
      return this.reset();
    }

    stop() {
      return this.paused = true;
    }

    start() {
      if (this.lives < 1) {
        this.reset();
      }
      this.lastTime = Date.now();
      this.paused = false;
      return this.main();
    }

    on_keyup(e) {
      return this.player.handleInput({
        37: 'left',
        38: 'up',
        39: 'right',
        40: 'down'
      }[e.keyCode]);
    }

    update(dt) {
      var enemy, i, j, len, len1, ref, ref1;
      ref = this.enemies;
      // update enemies
      for (i = 0, len = ref.length; i < len; i++) {
        enemy = ref[i];
        enemy.update(dt);
      }
      
      // update player
      this.player.update();
      ref1 = this.enemies;
      // check for collisions
      for (j = 0, len1 = ref1.length; j < len1; j++) {
        enemy = ref1[j];
        if (enemy.collision(this.player)) {
          this.lives--;
          this.score_board.update();
          if (this.lives > 0) {
            this.player.reset();
          }
        }
      }
      // check for success
      if (this.player.y < 0) {
        this.score++;
        this.score_board.update();
        return this.player.reset();
      }
    }

    render() {
      var col, enemy, i, img, j, k, len, ref, ref1, ref2, row;
// render the background
      for (row = i = 0, ref = this.numRows; (0 <= ref ? i < ref : i > ref); row = 0 <= ref ? ++i : --i) {
        img = this.resources.get(this.rowImages[row]);
        for (col = j = 0, ref1 = this.numCols; (0 <= ref1 ? j < ref1 : j > ref1); col = 0 <= ref1 ? ++j : --j) {
          this.context.drawImage(img, col * this.colWidth, row * this.rowHeight);
        }
      }
      ref2 = this.enemies;
      // render the enemies
      for (k = 0, len = ref2.length; k < len; k++) {
        enemy = ref2[k];
        enemy.render();
      }
      // render the player
      return this.player.render();
    }

    reset() {
      var enemy, i, len, ref;
      this.score = 0;
      this.lives = this.initLives;
      this.score_board.update();
      this.player.reset();
      ref = this.enemies;
      for (i = 0, len = ref.length; i < len; i++) {
        enemy = ref[i];
        enemy.reset();
      }
      this.lastTime = Date.now();
      return this.render();
    }

  };

  Entity = class Entity {
    constructor(engine, init_x, init_y, sprite1) {
      this.reset = this.reset.bind(this);
      this.render = this.render.bind(this);
      this.init_x = init_x;
      this.init_y = init_y;
      this.sprite = sprite1;
      this.numCols = engine.numCols;
      this.numRows = engine.numRows;
      this.colWidth = engine.colWidth;
      this.rowHeight = engine.rowHeight;
      this.context = engine.context;
      this.resources = engine.resources;
      this.reset();
    }

    reset() {
      this.x = this.init_x;
      return this.y = this.init_y;
    }

    render() {
      var img;
      img = this.resources.get(this.sprite);
      return this.context.drawImage(img, this.x, this.y);
    }

  };

  Enemy = class Enemy extends Entity {
    constructor(engine, row, speed, sprite) {
      var offset, x_init, y_init;
      // some of the images are taller than the rows
      // so I tweaked it here.
      offset = -20;
      x_init = -engine.colWidth;
      y_init = (engine.numRows - row - 1) * engine.rowHeight + offset;
      super(engine, x_init, y_init, sprite);
      this.collision = this.collision.bind(this);
      this.update = this.update.bind(this);
      // speed is 1 (min) .. 10 (max).
      this.speed = speed;
    }

    collision(entity) {
      var collision, x_max, x_min, y_max, y_min;
      boundMethodCheck(this, Enemy);
      x_min = Math.floor(this.x / this.colWidth) * this.colWidth;
      x_max = x_min + 2 * this.colWidth;
      y_min = Math.floor(this.y / this.rowHeight) * this.rowHeight;
      y_max = y_min + this.rowHeight;
      collision = entity.x >= x_min && entity.x < x_max && entity.y >= y_min && entity.y < y_max;
      return collision;
    }

    update(dt) {
      var dx;
      boundMethodCheck(this, Enemy);
      // reset if at right edge
      if (this.x >= this.numCols * this.colWidth) {
        return this.reset();
      } else {
        // otherwise increase x position appropriately
        dx = this.speed / 5 * dt * this.colWidth;
        return this.x = this.x + dx;
      }
    }

  };

  Player = class Player extends Entity {
    constructor(engine, sprite) {
      var col, offset, row, x_init, y_init;
      // start on the bottom row
      row = 1;
      // in the middle column
      col = (engine.numCols + 1) / 2;
      // some of the images are taller than the rows
      // so I tweaked it here.
      offset = -10;
      x_init = (col - 1) * engine.colWidth;
      y_init = (engine.numRows - row) * engine.rowHeight + offset;
      super(engine, x_init, y_init, sprite);
      this.update = this.update.bind(this);
      this.handleInput = this.handleInput.bind(this);
      this.move_left = this.move_left.bind(this);
      this.move_right = this.move_right.bind(this);
      this.move_up = this.move_up.bind(this);
      this.move_down = this.move_down.bind(this);
    }

    update(dt) {
      boundMethodCheck(this, Player);
      return dt = dt;
    }

    handleInput(direction) {
      var move;
      boundMethodCheck(this, Player);
      console.log(`direction: ${direction}`);
      move = {
        left: this.move_left,
        right: this.move_right,
        up: this.move_up,
        down: this.move_down
      }[direction];
      if (move != null) {
        return move();
      }
    }

    move_left() {
      boundMethodCheck(this, Player);
      if (this.x > 0) {
        return this.x -= this.colWidth;
      }
    }

    move_right() {
      boundMethodCheck(this, Player);
      if (this.x < (this.numCols - 1) * this.colWidth) {
        return this.x += this.colWidth;
      }
    }

    move_up() {
      boundMethodCheck(this, Player);
      if (this.y >= this.rowHeight) {
        return this.y -= this.rowHeight;
      } else if (this.y > 0) {
        return this.y -= this.rowHeight;
      } else {
        return this.reset();
      }
    }

    move_down() {
      boundMethodCheck(this, Player);
      // why minus 2 ? 
      if (this.y < (this.numRows - 2) * this.rowHeight) {
        return this.y += this.rowHeight;
      }
    }

  };

  init = function() {
    var engine;
    engine = new Engine();
    /*  Create a new Player object */
    engine.setPlayer(new Player(engine, "images/char-boy.png"));
    /*  Create several Enemy objects */
    engine.addEnemy(new Enemy(engine, 3, 8, 'images/enemy-bug.png'));
    engine.addEnemy(new Enemy(engine, 4, 7, 'images/enemy-bug.png'));
    engine.addEnemy(new Enemy(engine, 2, 5, 'images/enemy-bug.png'));
    return window.app = engine;
  };

  if (document.readyState === 'complete') {
    init();
  } else {
    document.onreadystatechange = function() {
      if (document.readyState === 'complete') {
        return init();
      }
    };
  }

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJjYWRlX2dhbWUuanMiLCJzb3VyY2VSb290IjoiLi4vLi4iLCJzb3VyY2VzIjpbImJ1aWxkL2FyY2FkZV9nYW1lLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUE7QUFBQSxNQUFBLEtBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUEsRUFBQSxTQUFBLEVBQUEsV0FBQSxFQUFBLElBQUE7SUFBQTs7RUFBTSxZQUFOLE1BQUEsVUFBQTtJQUVFLFdBQWEsQ0FBQSxDQUFBO1VBSWIsQ0FBQSxZQUFBLENBQUE7VUFZQSxDQUFBLFdBQUEsQ0FBQTtVQU1BLENBQUEsVUFBQSxDQUFBO1VBR0EsQ0FBQSxjQUFBLENBQUE7VUFNQSxDQUFBLGNBQUEsQ0FBQTtNQTlCRSxJQUFDLENBQUEsYUFBRCxHQUFpQixDQUFBO01BQ2pCLElBQUMsQ0FBQSxjQUFELEdBQWtCO0lBRlA7O0lBSWIsS0FBTyxDQUFDLEdBQUQsQ0FBQTtBQUNMLFVBQUE7TUFBQSxJQUFHLElBQUMsQ0FBQSxhQUFjLENBQUEsR0FBQSxDQUFsQjtBQUNFLGVBQU8sSUFBQyxDQUFBLGFBQWMsQ0FBQSxHQUFBLEVBRHhCO09BQUEsTUFBQTtRQUdFLElBQUMsQ0FBQSxhQUFjLENBQUEsR0FBQSxDQUFmLEdBQXNCO1FBQ3RCLEdBQUEsR0FBTSxJQUFJLEtBQUosQ0FBQTtRQUNOLEdBQUcsQ0FBQyxHQUFKLEdBQVU7ZUFDVixHQUFHLENBQUMsTUFBSixHQUFhLENBQUEsQ0FBQSxHQUFBO1VBQ1gsSUFBQyxDQUFBLGFBQWMsQ0FBQSxHQUFBLENBQWYsR0FBc0I7VUFDdEIsSUFBRyxJQUFDLENBQUEsT0FBRCxDQUFBLENBQUg7bUJBQ0UsSUFBQyxDQUFBLGNBQWMsQ0FBQyxPQUFoQixDQUF3QixRQUFBLENBQUMsRUFBRCxDQUFBO3FCQUFRLEVBQUEsQ0FBQTtZQUFSLENBQXhCLEVBREY7O1FBRlcsRUFOZjs7SUFESzs7SUFZUCxJQUFNLENBQUMsSUFBRCxDQUFBO01BQ0osSUFBSSxJQUFB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Q0FBQyxRQUFQLENBQWdCLElBQUksS0FBSixDQUFVLE1BQVYsRUFBa0IsQ0FBbEIsRUFBcUIsQ0FBckIsRUFBd0Isc0JBQXhCLENBQWhCO0lBQ0EsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsSUFBSSxLQUFKLENBQVUsTUFBVixFQUFrQixDQUFsQixFQUFxQixDQUFyQixFQUF3QixzQkFBeEIsQ0FBaEI7SUFDQSxNQUFNLENBQUMsUUFBUCxDQUFnQixJQUFJLEtBQUosQ0FBVSxNQUFWLEVBQWtCLENBQWxCLEVBQXFCLENBQXJCLEVBQXdCLHNCQUF4QixDQUFoQjtXQUVBLE1BQU0sQ0FBQyxHQUFQLEdBQWE7RUFaUjs7RUFlUCxJQUFHLFFBQVEsQ0FBQyxVQUFULEtBQXVCLFVBQTFCO0lBQ0UsSUFBQSxDQUFBLEVBREY7R0FBQSxNQUFBO0lBR0UsUUFBUSxDQUFDLGtCQUFULEdBQThCLFFBQUEsQ0FBQSxDQUFBO01BQzVCLElBQUcsUUFBUSxDQUFDLFVBQVQsS0FBdUIsVUFBMUI7ZUFDRSxJQUFBLENBQUEsRUFERjs7SUFENEIsRUFIaEM7O0FBelVBIiwic291cmNlc0NvbnRlbnQiOlsiXG5cbmNsYXNzIFJlc291cmNlc1xuXG4gIGNvbnN0cnVjdG9yOiAtPlxuICAgIEByZXNvdXJjZUNhY2hlID0ge31cbiAgICBAcmVhZHlDYWxsYmFja3MgPSBbXVxuXG4gIF9sb2FkOiAodXJsKSA9PlxuICAgIGlmIEByZXNvdXJjZUNhY2hlW3VybF1cbiAgICAgIHJldHVybiBAcmVzb3VyY2VDYWNoZVt1cmxdXG4gICAgZWxzZSBcbiAgICAgIEByZXNvdXJjZUNhY2hlW3VybF0gPSB1bmRlZmluZWRcbiAgICAgIGltZyA9IG5ldyBJbWFnZSgpXG4gICAgICBpbWcuc3JjID0gdXJsXG4gICAgICBpbWcub25sb2FkID0gPT5cbiAgICAgICAgQHJlc291cmNlQ2FjaGVbdXJsXSA9IGltZ1xuICAgICAgICBpZiBAaXNSZWFkeSgpXG4gICAgICAgICAgQHJlYWR5Q2FsbGJhY2tzLmZvckVhY2goKGNiKSAtPiBjYigpKVxuXG4gIGxvYWQ6ICh1cmxzKSA9PlxuICAgIGlmICh1cmxzIGluc3RhbmNlb2YgQXJyYXkpXG4gICAgICB1cmxzLmZvckVhY2goQF9sb2FkKVxuICAgIGVsc2UgXG4gICAgICBAX2xvYWQodXJscylcblxuICBnZXQ6ICh1cmwpID0+XG4gICAgQHJlc291cmNlQ2FjaGVbdXJsXVxuXG4gIGlzUmVhZHk6ID0+XG4gICAgcmVhZHkgPSB0cnVlXG4gICAgZm9yIF8scmVzb3VyY2Ugb2YgQHJlc291cmNlQ2FjaGVcbiAgICAgIHJlYWR5ICY9IHJlc291cmNlP1xuICAgIHJldHVybiByZWFkeVxuXG4gIG9uUmVhZHk6IChjYikgPT5cbiAgICBAcmVhZHlDYWxsYmFja3MucHVzaChjYilcblxuXG5jbGFzcyBTY29yZV9Cb2FyZFxuXG4gIGNvbnN0cnVjdG9yOiAoQGVuZ2luZSkgLT5cbiAgICBAc2NvcmVfZWx0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY29yZVwiKVxuICAgIEBsaXZlc19lbHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxpdmVzXCIpXG5cbiAgdXBkYXRlOiA9PlxuICAgIEBzY29yZV9lbHQuaW5uZXJIVE1MID0gXCJTY29yZTogI3tAZW5naW5lLnNjb3JlfVwiXG4gICAgQGxpdmVzX2VsdC5pbm5lckhUTUwgPSBcIkxpdmVzOiAje0BlbmdpbmUubGl2ZXN9XCJcblxuXG4gICAgXG5jbGFzcyBFbmdpbmVcblxuICBjb25zdHJ1Y3RvcjogLT5cblxuICAgIEBudW1Db2xzID0gNVxuICAgIEBudW1Sb3dzID0gNlxuICAgIEBpbml0TGl2ZXMgPSAxMFxuXG4gICAgQGNvbFdpZHRoID0gMTAxXG4gICAgQHJvd0hlaWdodCA9IDgzXG5cbiAgICBAc2NvcmVfYm9hcmQgPSBuZXcgU2NvcmVfQm9hcmQodGhpcylcblxuICAgIEBsYXN0VGltZSA9IG51bGxcbiAgICBAZW5lbWllcyA9IFtdXG5cbiAgICBAcGxheWVyID0gbnVsbFxuICAgIEBwYXVzZWQgPSBmYWxzZVxuXG4gICAgQHJvd0ltYWdlcyA9IFtcbiAgICAgICdpbWFnZXMvd2F0ZXItYmxvY2sucG5nJyAgICMgVG9wIHJvdyBpcyB3YXRlclxuICAgICAgJ2ltYWdlcy9zdG9uZS1ibG9jay5wbmcnICAgIyBSb3cgMSBvZiAzIG9mIHN0b25lXG4gICAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZycgICAjIFJvdyAyIG9mIDMgb2Ygc3RvbmVcbiAgICAgICdpbWFnZXMvc3RvbmUtYmxvY2sucG5nJyAgICMgUm93IDMgb2YgMyBvZiBzdG9uZVxuICAgICAgJ2ltYWdlcy9ncmFzcy1ibG9jay5wbmcnICAgIyBSb3cgMSBvZiAyIG9mIGdyYXNzXG4gICAgICAnaW1hZ2VzL2dyYXNzLWJsb2NrLnBuZycgICAjIFJvdyAyIG9mIDIgb2YgZ3Jhc3NcbiAgICAgIF1cblxuICAgIEByZXNvdXJjZXMgPSBuZXcgUmVzb3VyY2VzKClcbiAgICBAcmVzb3VyY2VzLm9uUmVhZHkoQHJlc2V0KVxuICAgIEByZXNvdXJjZXMubG9hZChbXG4gICAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZydcbiAgICAgICdpbWFnZXMvd2F0ZXItYmxvY2sucG5nJ1xuICAgICAgJ2ltYWdlcy9ncmFzcy1ibG9jay5wbmcnXG4gICAgICAnaW1hZ2VzL2VuZW15LWJ1Zy5wbmcnXG4gICAgICAnaW1hZ2VzL2NoYXItYm95LnBuZydcbiAgICAgIF0pXG4gICAgXG4gICAgQGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpXG4gICAgQGNhbnZhcy53aWR0aCA9IEBudW1Db2xzICogQGNvbFdpZHRoXG4gICAgQGNhbnZhcy5oZWlnaHQgPSBAbnVtUm93cyAqIEByb3dIZWlnaHQgKyAxMDBcbiAgICBAY29udGV4dCA9IEBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChAY2FudmFzKVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgQG9uX2tleXVwKVxuXG5cblxuICAjIGNsYXNzIEVuZ2luZSBtZXRob2RzXG5cbiAgIyBwbGF5ZXIgZ2V0dGVyKCkgYW5kIHNldHRlcigpIG1ldGhvZHNcbiAgc2V0UGxheWVyOiAocCkgPT4gQHBsYXllciA9IHBcbiAgZ2V0UGxheWVyOiA9PiBAcGxheWVyXG5cbiAgIyBhZGQgYW5kIGdldCBlbmVtaWVzXG4gIGFkZEVuZW15OiAoZSkgPT4gQGVuZW1pZXMucHVzaChlKVxuICBnZXRFbmVtaWVzOiA9PiBAZW5lbWllc1xuXG4gICMgbWFpbiBsb29wXG4gIG1haW46ID0+XG4gICAgbm93ID0gRGF0ZS5ub3coKVxuICAgIGR0ID0gKG5vdyAtIEBsYXN0VGltZSkgLyAxMDAwLjBcbiAgICBAdXBkYXRlKGR0KVxuICAgIEByZW5kZXIoKVxuICAgIGlmIG5vdCBAcGF1c2VkICYmIEBsaXZlcyA+IDAgXG4gICAgICBAbGFzdFRpbWUgPSBub3dcbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoQG1haW4pXG5cbiAgIyBwYXVzZSB0aGUgZ2FtZVxuICB0b2dnbGVfcGF1c2U6ID0+XG4gICAgaWYgQHBhdXNlZFxuICAgICAgQHN0YXJ0KClcbiAgICBlbHNlXG4gICAgICBAc3RvcCgpXG5cbiAgIyBpbml0aWFsaXplIGFuZCBzdGFydCB0aGUgZ2FtZVxuICBpbml0OiA9PlxuICAgIEBwYXVzZWQgPSB0cnVlXG4gICAgQHJlc2V0KClcblxuICBzdG9wOiA9PlxuICAgIEBwYXVzZWQgPSB0cnVlXG4gICAgXG4gIHN0YXJ0OiA9PlxuICAgIGlmIEBsaXZlcyA8IDFcbiAgICAgIEByZXNldCgpXG4gICAgQGxhc3RUaW1lID0gRGF0ZS5ub3coKVxuICAgIEBwYXVzZWQgPSBmYWxzZVxuICAgIEBtYWluKClcblxuICAjIGhhbmRsZSBwbGF5ZXIga2V5IHByZXNzXG4gIG9uX2tleXVwOiAoZSkgPT5cbiAgICBAcGxheWVyLmhhbmRsZUlucHV0KHtcbiAgICAgIDM3OiAnbGVmdCdcbiAgICAgIDM4OiAndXAnXG4gICAgICAzOTogJ3JpZ2h0J1xuICAgICAgNDA6ICdkb3duJ1xuICAgICAgfVtlLmtleUNvZGVdKVxuXG4gICMgdXBkYXRlIHRoZSBwb3NpdGlvbnMgb2YgdGhlIGVudGl0aWVzIGFuZCBhY3QgYWNjb3JkaW5nbHlcbiAgdXBkYXRlOiAoZHQpID0+XG5cbiAgICAjIHVwZGF0ZSBlbmVtaWVzXG4gICAgZm9yIGVuZW15IGluIEBlbmVtaWVzXG4gICAgICBlbmVteS51cGRhdGUoZHQpXG4gICAgICBcbiAgICAjIHVwZGF0ZSBwbGF5ZXJcbiAgICBAcGxheWVyLnVwZGF0ZSgpXG5cbiAgICAjIGNoZWNrIGZvciBjb2xsaXNpb25zXG4gICAgZm9yIGVuZW15IGluIEBlbmVtaWVzXG4gICAgICBpZiAoZW5lbXkuY29sbGlzaW9uKEBwbGF5ZXIpKVxuICAgICAgICBAbGl2ZXMtLVxuICAgICAgICBAc2NvcmVfYm9hcmQudXBkYXRlKClcbiAgICAgICAgaWYgQGxpdmVzID4gMFxuICAgICAgICAgIEBwbGF5ZXIucmVzZXQoKVxuXG4gICAgIyBjaGVjayBmb3Igc3VjY2Vzc1xuICAgIGlmIChAcGxheWVyLnkgPCAwKSBcbiAgICAgIEBzY29yZSsrXG4gICAgICBAc2NvcmVfYm9hcmQudXBkYXRlKClcbiAgICAgIEBwbGF5ZXIucmVzZXQoKVxuXG5cbiAgIyByZW5kZXIgdGhlIGdhbWUgYm9hcmRcbiAgcmVuZGVyOiA9PlxuXG4gICAgIyByZW5kZXIgdGhlIGJhY2tncm91bmRcbiAgICBmb3Igcm93IGluIFswLi4uQG51bVJvd3NdXG4gICAgICBpbWcgPSBAcmVzb3VyY2VzLmdldChAcm93SW1hZ2VzW3Jvd10pXG4gICAgICBmb3IgY29sIGluIFswLi4uQG51bUNvbHNdXG4gICAgICAgIEBjb250ZXh0LmRyYXdJbWFnZShpbWcsIGNvbCAqIEBjb2xXaWR0aCwgcm93ICogQHJvd0hlaWdodClcblxuICAgICMgcmVuZGVyIHRoZSBlbmVtaWVzXG4gICAgZm9yIGVuZW15IGluIEBlbmVtaWVzXG4gICAgICBlbmVteS5yZW5kZXIoKVxuXG4gICAgIyByZW5kZXIgdGhlIHBsYXllclxuICAgIEBwbGF5ZXIucmVuZGVyKClcblxuXG4gICMgcmVzZXQgZ2FtZSBcbiAgcmVzZXQ6ID0+XG4gICAgQHNjb3JlID0gMFxuICAgIEBsaXZlcyA9IEBpbml0TGl2ZXNcbiAgICBAc2NvcmVfYm9hcmQudXBkYXRlKClcbiAgICBAcGxheWVyLnJlc2V0KClcbiAgICBmb3IgZW5lbXkgaW4gQGVuZW1pZXNcbiAgICAgIGVuZW15LnJlc2V0KClcbiAgICBAbGFzdFRpbWUgPSBEYXRlLm5vdygpXG4gICAgQHJlbmRlcigpXG5cblxuXG5cbmNsYXNzIEVudGl0eVxuXG4gIGNvbnN0cnVjdG9yOiAoZW5naW5lLCBAaW5pdF94LCBAaW5pdF95LCBAc3ByaXRlKSAtPlxuICAgIEBudW1Db2xzID0gZW5naW5lLm51bUNvbHNcbiAgICBAbnVtUm93cyA9IGVuZ2luZS5udW1Sb3dzXG4gICAgQGNvbFdpZHRoID0gZW5naW5lLmNvbFdpZHRoXG4gICAgQHJvd0hlaWdodCA9IGVuZ2luZS5yb3dIZWlnaHRcbiAgICBAY29udGV4dCA9IGVuZ2luZS5jb250ZXh0XG4gICAgQHJlc291cmNlcyA9IGVuZ2luZS5yZXNvdXJjZXNcbiAgICBAcmVzZXQoKVxuXG4gIHJlc2V0OiA9PlxuICAgIEB4ID0gQGluaXRfeFxuICAgIEB5ID0gQGluaXRfeVxuXG4gIHJlbmRlcjogPT5cbiAgICBpbWcgPSBAcmVzb3VyY2VzLmdldChAc3ByaXRlKVxuICAgIEBjb250ZXh0LmRyYXdJbWFnZShpbWcsIEB4LCBAeSlcblxuXG5jbGFzcyBFbmVteSBleHRlbmRzIEVudGl0eVxuXG4gIGNvbnN0cnVjdG9yOiAoZW5naW5lLCByb3csIHNwZWVkLCBzcHJpdGUpIC0+XG5cbiAgICAjIHNvbWUgb2YgdGhlIGltYWdlcyBhcmUgdGFsbGVyIHRoYW4gdGhlIHJvd3NcbiAgICAjIHNvIEkgdHdlYWtlZCBpdCBoZXJlLlxuICAgIG9mZnNldCA9IC0yMFxuICAgIHhfaW5pdCA9IC1lbmdpbmUuY29sV2lkdGhcbiAgICB5X2luaXQgPSAoZW5naW5lLm51bVJvd3Mtcm93LTEpICogZW5naW5lLnJvd0hlaWdodCArIG9mZnNldFxuICAgIHN1cGVyKGVuZ2luZSwgeF9pbml0LCB5X2luaXQsIHNwcml0ZSlcblxuICAgICMgc3BlZWQgaXMgMSAobWluKSAuLiAxMCAobWF4KS5cbiAgICBAc3BlZWQgPSBzcGVlZFxuXG4gIGNvbGxpc2lvbjogKGVudGl0eSkgPT5cbiAgICB4X21pbiA9IE1hdGguZmxvb3IoQHgvQGNvbFdpZHRoKSAqIEBjb2xXaWR0aFxuICAgIHhfbWF4ID0geF9taW4gKyAyICogQGNvbFdpZHRoXG4gICAgeV9taW4gPSBNYXRoLmZsb29yKEB5L0Byb3dIZWlnaHQpICogQHJvd0hlaWdodFxuICAgIHlfbWF4ID0geV9taW4gKyBAcm93SGVpZ2h0XG4gICAgY29sbGlzaW9uID0gXG4gICAgICBlbnRpdHkueCA+PSB4X21pbiAmJiBlbnRpdHkueCA8ICB4X21heCAmJlxuICAgICAgZW50aXR5LnkgPj0geV9taW4gJiYgZW50aXR5LnkgPCAgeV9tYXhcbiAgICByZXR1cm4gY29sbGlzaW9uXG5cbiAgdXBkYXRlOiAoZHQpID0+XG4gICAgIyByZXNldCBpZiBhdCByaWdodCBlZGdlXG4gICAgaWYgKEB4ID49IEBudW1Db2xzICogQGNvbFdpZHRoKSBcbiAgICAgIEByZXNldCgpXG5cbiAgICAjIG90aGVyd2lzZSBpbmNyZWFzZSB4IHBvc2l0aW9uIGFwcHJvcHJpYXRlbHlcbiAgICBlbHNlIFxuICAgICAgZHggPSBAc3BlZWQvNSAqIGR0ICogQGNvbFdpZHRoXG4gICAgICBAeCA9IEB4ICsgZHhcblxuXG5cbmNsYXNzIFBsYXllciBleHRlbmRzIEVudGl0eVxuXG4gIGNvbnN0cnVjdG9yOiAoZW5naW5lLCBzcHJpdGUpIC0+XG4gICAgIyBzdGFydCBvbiB0aGUgYm90dG9tIHJvd1xuICAgIHJvdyA9IDFcbiAgICAjIGluIHRoZSBtaWRkbGUgY29sdW1uXG4gICAgY29sID0gKGVuZ2luZS5udW1Db2xzKzEpLzJcblxuICAgICMgc29tZSBvZiB0aGUgaW1hZ2VzIGFyZSB0YWxsZXIgdGhhbiB0aGUgcm93c1xuICAgICMgc28gSSB0d2Vha2VkIGl0IGhlcmUuXG4gICAgb2Zmc2V0ID0gLTEwXG4gICAgeF9pbml0ID0gKGNvbC0xKSAqIGVuZ2luZS5jb2xXaWR0aFxuICAgIHlfaW5pdCA9IChlbmdpbmUubnVtUm93cy1yb3cpICogZW5naW5lLnJvd0hlaWdodCArIG9mZnNldFxuXG4gICAgc3VwZXIoZW5naW5lLCB4X2luaXQsIHlfaW5pdCwgc3ByaXRlKVxuXG5cbiAgdXBkYXRlOiAoZHQpID0+XG4gICAgZHQgPSBkdFxuXG4gIGhhbmRsZUlucHV0OiAoZGlyZWN0aW9uKSA9PlxuICAgIGNvbnNvbGUubG9nKFwiZGlyZWN0aW9uOiAje2RpcmVjdGlvbn1cIilcbiAgICBtb3ZlID0ge1xuICAgICAgbGVmdDogQG1vdmVfbGVmdFxuICAgICAgcmlnaHQ6IEBtb3ZlX3JpZ2h0XG4gICAgICB1cDogQG1vdmVfdXBcbiAgICAgIGRvd246IEBtb3ZlX2Rvd25cbiAgICAgIH1bZGlyZWN0aW9uXVxuICAgIGlmIG1vdmU/XG4gICAgICBtb3ZlKClcblxuICBtb3ZlX2xlZnQ6ID0+XG4gICAgaWYgKEB4ID4gMClcbiAgICAgIEB4IC09IEBjb2xXaWR0aFxuXG4gIG1vdmVfcmlnaHQ6ID0+XG4gICAgaWYgKEB4IDwgKEBudW1Db2xzLTEpICogQGNvbFdpZHRoKVxuICAgICAgQHggKz0gQGNvbFdpZHRoXG5cbiAgbW92ZV91cDogPT5cbiAgICBpZiAoQHkgPj0gQHJvd0hlaWdodCkgXG4gICAgICBAeSAtPSBAcm93SGVpZ2h0XG4gICAgZWxzZSBpZiAoQHkgPiAwKSBcbiAgICAgIEB5IC09IEByb3dIZWlnaHRcbiAgICBlbHNlIFxuICAgICAgQHJlc2V0KClcblxuICBtb3ZlX2Rvd246ID0+XG4gICAgIyB3aHkgbWludXMgMiA/IFxuICAgIGlmIChAeSA8IChAbnVtUm93cyAtIDIpICogQHJvd0hlaWdodCkgXG4gICAgICBAeSArPSBAcm93SGVpZ2h0XG5cbiAgICBcblxuaW5pdCA9IC0+XG5cbiAgZW5naW5lID0gbmV3IEVuZ2luZSgpXG4gIFxuICAjIyMgIENyZWF0ZSBhIG5ldyBQbGF5ZXIgb2JqZWN0ICMjI1xuICBlbmdpbmUuc2V0UGxheWVyKG5ldyBQbGF5ZXIoZW5naW5lLCBcImltYWdlcy9jaGFyLWJveS5wbmdcIikpXG5cbiAgIyMjICBDcmVhdGUgc2V2ZXJhbCBFbmVteSBvYmplY3RzICMjI1xuICBlbmdpbmUuYWRkRW5lbXkobmV3IEVuZW15KGVuZ2luZSwgMywgOCwgJ2ltYWdlcy9lbmVteS1idWcucG5nJykpXG4gIGVuZ2luZS5hZGRFbmVteShuZXcgRW5lbXkoZW5naW5lLCA0LCA3LCAnaW1hZ2VzL2VuZW15LWJ1Zy5wbmcnKSlcbiAgZW5naW5lLmFkZEVuZW15KG5ldyBFbmVteShlbmdpbmUsIDIsIDUsICdpbWFnZXMvZW5lbXktYnVnLnBuZycpKVxuXG4gIHdpbmRvdy5hcHAgPSBlbmdpbmVcblxuXG5pZiBkb2N1bWVudC5yZWFkeVN0YXRlID09ICdjb21wbGV0ZSdcbiAgaW5pdCgpXG5lbHNlXG4gIGRvY3VtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IC0+XG4gICAgaWYgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnXG4gICAgICBpbml0KClcblxuXG4iXX0=
//# sourceURL=/usr/local/server/git/clones/p3-arcade-game/build/arcade_game.coffee